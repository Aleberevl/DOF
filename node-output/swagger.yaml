openapi: 3.0.3
info:
  title: API del Diario Oficial Federado - Archivos DOF
  description: |
    Especificación de la API para recuperar archivos del Diario Oficial Federado (DOF) y visualizar el
    archivo completo, incluyendo sus metadatos (información de la tabla files y datos básicos de
    publications) y las páginas relacionadas desde la tabla pages, con su texto e imagen por página,
    para facilitar la consulta detallada de cada documento.
    incluyendo sus metadatos y páginas relacionadas.
  version: 1.0.0
servers:
- url: https://virtserver.swaggerhub.com/itesm-897/api_dof/1.0.0
  description: SwaggerHub API Auto Mocking
- url: https://virtserver.swaggerhub.com/tecnologicodemonterr-61b/DOD/1.0.0
  description: SwaggerHub API Auto Mocking
tags:
- name: Archivos DOF
  description: Rutas para consultar y visualizar archivos oficiales del DOF.
paths:
  /dof/files:
    get:
      tags:
      - Archivos DOF
      summary: Recuperar archivos DOF
      description: "Obtiene todos los archivos del Diario Oficial Federado, junto con la publicación a la que pertenecen."
      responses:
        "200":
          description: Lista de archivos DOF recuperada exitosamente.
          content:
            application/json:
              schema:
                type: array
                items:
                  $ref: "#/components/schemas/inline_response_200"
        "201":
          description: Created
        "400":
          description: Bad Request
        "404":
          description: Not Found
  /dof/files/{file_id}:
    get:
      tags:
      - Archivos DOF
      summary: Visualizar archivo completo
      description: "Devuelve el archivo DOF correspondiente al ID indicado, con sus páginas o texto completo si está disponible."
      parameters:
      - name: file_id
        in: path
        description: ID del archivo DOF
        required: true
        style: simple
        explode: false
        schema:
          type: integer
      responses:
        "200":
          description: Archivo DOF recuperado exitosamente.
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/inline_response_200_1"
        "400":
          description: Bad Request
        "404":
          description: Not Found
  /dof/publications:
    get:
      tags: []
      summary: Recuperar publicaciones
      operationId: get-dof-publications
      requestBody:
        content:
          application/json:
            schema:
              $ref: "#/components/schemas/dof_publications_body"
      responses:
        "200":
          description: OK
        "400":
          description: Bad Request
        "401":
          description: Unauthorized
components:
  schemas:
    inline_response_200:
      required:
      - id
      - publication_date
      - publication_id
      - publication_type
      - source_url
      - storage_uri
      type: object
      properties:
        id:
          type: integer
          example: 1
        publication_id:
          type: integer
          example: 10
        storage_uri:
          type: string
          example: s3://dof-storage/2025-11-06/001.pdf
        mime:
          type: string
          example: application/pdf
        bytes:
          type: integer
          example: 2048000
        sha256:
          type: string
          example: a2b8e8c9d1f34b8d7e42e6c8f77f74a1b2...
        has_ocr:
          type: boolean
          example: true
        pages_count:
          type: integer
          example: 24
        publication_date:
          type: string
          format: date
          example: 2025-11-06
        publication_type:
          type: string
          example: DOF
        source_url:
          type: string
          example: https://dof.gob.mx/nota_detalle.php?codigo=1234567
    inline_response_200_1:
      required:
      - id
      - pages
      - publication_id
      - storage_uri
      - summary
      type: object
      properties:
        id:
          type: integer
          example: 1
        publication_id:
          type: integer
          example: 10
        storage_uri:
          type: string
          example: s3://dof-storage/2025-11-06/001.pdf
        mime:
          type: string
          example: application/pdf
        has_ocr:
          type: boolean
          example: true
        pages:
          type: array
          items:
            $ref: "#/components/schemas/inline_response_200_1_pages"
        summary:
          type: string
          example: "Resumen del decreto: principales incentivos fiscales para PYMES."
    Publications:
      required:
      - Entity
      type: object
      properties:
        Entity:
          $ref: "#/components/schemas/Publications_Entity"
        Item:
          $ref: "#/components/schemas/Publications_Item"
        Section:
          $ref: "#/components/schemas/dofpublications_Section"
        PublicationPage:
          $ref: "#/components/schemas/dofpublications_PublicationPage"
      x-examples:
        Example 1:
          Entity:
            type: object
            description: "Entidad nombrada (persona, organización, ley, etc.) detectada dentro de un Ítem."
            required:
            - id
            - name
            - type
            - normalized_name
            properties:
              id:
                type: integer
                description: ID de la entidad.
              name:
                type: string
                description: Nombre de la entidad tal como aparece originalmente.
              type:
                type: string
                description: "Tipo de entidad (e.g., 'PERSONA', 'LEY', 'INSTITUCION')."
              normalized_name:
                type: string
                description: Nombre estandarizado para la entidad.
              evidence:
                type: string
                nullable: true
                description: Fragmento de texto donde se encontró la entidad.
          Item:
            type: object
            description: Un artículo o acuerdo específico dentro de una Sección.
            required:
            - id
            - type
            - title
            - page_range
            properties:
              id:
                type: integer
                description: ID del ítem.
              type:
                type: string
                description: Tipo de contenido del ítem.
              title:
                type: string
                description: "Título del ítem (e.g., 'Acuerdo', 'Decreto')."
              issuing_entity:
                type: string
                nullable: true
                description: Entidad que emite el ítem.
              page_range:
                type: array
                description: "[Página inicial, Página final] del ítem."
                items:
                  type: integer
                minItems: 2
                maxItems: 2
              raw_text:
                type: string
                nullable: true
                description: Texto sin procesar del ítem.
              summary:
                type: string
                nullable: true
                description: Resumen del ítem generado (LLM).
              entities:
                type: array
                description: Lista de entidades nombradas extraídas.
                items:
                  $ref: "#/components/schemas/Entity"
          Section:
            type: object
            description: "Una sección organizativa dentro de la publicación (e.g., 'SECRETARÍA DE HACIENDA Y CRÉDITO PÚBLICO')."
            required:
            - id
            - name
            - sequence
            - page_range
            - items
            properties:
              id:
                type: integer
                description: ID de la sección.
              name:
                type: string
                description: Nombre oficial de la sección.
              sequence:
                type: integer
                description: Orden secuencial de la sección.
              page_range:
                type: array
                description: "[Página inicial, Página final] de la sección."
                items:
                  type: integer
                minItems: 2
                maxItems: 2
              items:
                type: array
                description: Artículos o acuerdos contenidos en la sección.
                items:
                  $ref: "#/components/schemas/Item"
          PublicationPage:
            type: object
            description: Detalle del contenido y la imagen de una página específica del archivo.
            required:
            - page_no
            properties:
              page_no:
                type: integer
                description: Número de página.
              text:
                type: string
                nullable: true
                description: Contenido de texto (OCR) de la página.
              image_uri:
                type: string
                nullable: true
                description: URI de la imagen renderizada de la página.
    dofpublications_Entity_properties_id:
      type: object
      properties:
        type:
          type: string
        description:
          type: string
    dofpublications_Entity_properties_evidence:
      type: object
      properties:
        type:
          type: string
        nullable:
          type: boolean
        description:
          type: string
    dofpublications_Entity_properties:
      type: object
      properties:
        id:
          $ref: "#/components/schemas/dofpublications_Entity_properties_id"
        name:
          $ref: "#/components/schemas/dofpublications_Entity_properties_id"
        type:
          $ref: "#/components/schemas/dofpublications_Entity_properties_id"
        normalized_name:
          $ref: "#/components/schemas/dofpublications_Entity_properties_id"
        evidence:
          $ref: "#/components/schemas/dofpublications_Entity_properties_evidence"
    dofpublications_Entity:
      type: object
      properties:
        type:
          type: string
        description:
          type: string
        required:
          type: array
          items:
            type: string
        properties:
          $ref: "#/components/schemas/dofpublications_Entity_properties"
    dofpublications_Item_properties_page_range_items:
      type: object
      properties:
        type:
          type: string
    dofpublications_Item_properties_page_range:
      type: object
      properties:
        type:
          type: string
        description:
          type: string
        items:
          $ref: "#/components/schemas/dofpublications_Item_properties_page_range_items"
        minItems:
          type: integer
        maxItems:
          type: integer
    dofpublications_Item_properties_entities_items:
      type: object
      properties:
        $ref:
          type: string
    dofpublications_Item_properties_entities:
      type: object
      properties:
        type:
          type: string
        description:
          type: string
        items:
          $ref: "#/components/schemas/dofpublications_Item_properties_entities_items"
    dofpublications_Item_properties:
      type: object
      properties:
        id:
          $ref: "#/components/schemas/dofpublications_Entity_properties_id"
        type:
          $ref: "#/components/schemas/dofpublications_Entity_properties_id"
        title:
          $ref: "#/components/schemas/dofpublications_Entity_properties_id"
        issuing_entity:
          $ref: "#/components/schemas/dofpublications_Entity_properties_evidence"
        page_range:
          $ref: "#/components/schemas/dofpublications_Item_properties_page_range"
        raw_text:
          $ref: "#/components/schemas/dofpublications_Entity_properties_evidence"
        summary:
          $ref: "#/components/schemas/dofpublications_Entity_properties_evidence"
        entities:
          $ref: "#/components/schemas/dofpublications_Item_properties_entities"
    dofpublications_Item:
      type: object
      properties:
        type:
          type: string
        description:
          type: string
        required:
          type: array
          items:
            type: string
        properties:
          $ref: "#/components/schemas/dofpublications_Item_properties"
    dofpublications_Section_properties:
      type: object
      properties:
        id:
          $ref: "#/components/schemas/dofpublications_Entity_properties_id"
        name:
          $ref: "#/components/schemas/dofpublications_Entity_properties_id"
        sequence:
          $ref: "#/components/schemas/dofpublications_Entity_properties_id"
        page_range:
          $ref: "#/components/schemas/dofpublications_Item_properties_page_range"
        items:
          $ref: "#/components/schemas/dofpublications_Item_properties_entities"
    dofpublications_Section:
      type: object
      properties:
        type:
          type: string
        description:
          type: string
        required:
          type: array
          items:
            type: string
        properties:
          $ref: "#/components/schemas/dofpublications_Section_properties"
    dofpublications_PublicationPage_properties:
      type: object
      properties:
        page_no:
          $ref: "#/components/schemas/dofpublications_Entity_properties_id"
        text:
          $ref: "#/components/schemas/dofpublications_Entity_properties_evidence"
        image_uri:
          $ref: "#/components/schemas/dofpublications_Entity_properties_evidence"
    dofpublications_PublicationPage:
      type: object
      properties:
        type:
          type: string
        description:
          type: string
        required:
          type: array
          items:
            type: string
        properties:
          $ref: "#/components/schemas/dofpublications_PublicationPage_properties"
    dof_publications_body:
      type: object
      properties:
        Entity:
          $ref: "#/components/schemas/dofpublications_Entity"
        Item:
          $ref: "#/components/schemas/dofpublications_Item"
        Section:
          $ref: "#/components/schemas/dofpublications_Section"
        PublicationPage:
          $ref: "#/components/schemas/dofpublications_PublicationPage"
      x-examples:
        Example 1:
          Entity:
            type: object
            description: "Entidad nombrada (persona, organización, ley, etc.) detectada dentro de un Ítem."
            required:
            - id
            - name
            - type
            - normalized_name
            properties:
              id:
                type: integer
                description: ID de la entidad.
              name:
                type: string
                description: Nombre de la entidad tal como aparece originalmente.
              type:
                type: string
                description: "Tipo de entidad (e.g., 'PERSONA', 'LEY', 'INSTITUCION')."
              normalized_name:
                type: string
                description: Nombre estandarizado para la entidad.
              evidence:
                type: string
                nullable: true
                description: Fragmento de texto donde se encontró la entidad.
          Item:
            type: object
            description: Un artículo o acuerdo específico dentro de una Sección.
            required:
            - id
            - type
            - title
            - page_range
            properties:
              id:
                type: integer
                description: ID del ítem.
              type:
                type: string
                description: Tipo de contenido del ítem.
              title:
                type: string
                description: "Título del ítem (e.g., 'Acuerdo', 'Decreto')."
              issuing_entity:
                type: string
                nullable: true
                description: Entidad que emite el ítem.
              page_range:
                type: array
                description: "[Página inicial, Página final] del ítem."
                items:
                  type: integer
                minItems: 2
                maxItems: 2
              raw_text:
                type: string
                nullable: true
                description: Texto sin procesar del ítem.
              summary:
                type: string
                nullable: true
                description: Resumen del ítem generado (LLM).
              entities:
                type: array
                description: Lista de entidades nombradas extraídas.
                items:
                  $ref: "#/components/schemas/Entity"
          Section:
            type: object
            description: "Una sección organizativa dentro de la publicación (e.g., 'SECRETARÍA DE HACIENDA Y CRÉDITO PÚBLICO')."
            required:
            - id
            - name
            - sequence
            - page_range
            - items
            properties:
              id:
                type: integer
                description: ID de la sección.
              name:
                type: string
                description: Nombre oficial de la sección.
              sequence:
                type: integer
                description: Orden secuencial de la sección.
              page_range:
                type: array
                description: "[Página inicial, Página final] de la sección."
                items:
                  type: integer
                minItems: 2
                maxItems: 2
              items:
                type: array
                description: Artículos o acuerdos contenidos en la sección.
                items:
                  $ref: "#/components/schemas/Item"
          PublicationPage:
            type: object
            description: Detalle del contenido y la imagen de una página específica del archivo.
            required:
            - page_no
            properties:
              page_no:
                type: integer
                description: Número de página.
              text:
                type: string
                nullable: true
                description: Contenido de texto (OCR) de la página.
              image_uri:
                type: string
                nullable: true
                description: URI de la imagen renderizada de la página.
    inline_response_200_1_pages:
      required:
      - image_uri
      - page_no
      - text
      type: object
      properties:
        page_no:
          type: integer
          example: 1
        text:
          type: string
          example: Texto extraído de la primera página...
        image_uri:
          type: string
          example: https://s3.amazonaws.com/dof-storage/2025-11-06/page1.png
    Publications_Entity_properties:
      required:
      - name
      - normalized_name
      - type
      type: object
      properties:
        id:
          $ref: "#/components/schemas/dofpublications_Entity_properties_id"
        name:
          $ref: "#/components/schemas/dofpublications_Entity_properties_id"
        type:
          $ref: "#/components/schemas/dofpublications_Entity_properties_id"
        normalized_name:
          $ref: "#/components/schemas/dofpublications_Entity_properties_id"
        evidence:
          $ref: "#/components/schemas/dofpublications_Entity_properties_evidence"
    Publications_Entity:
      required:
      - description
      - type
      type: object
      properties:
        type:
          type: string
        description:
          type: string
        required:
          type: array
          items:
            type: string
        properties:
          $ref: "#/components/schemas/Publications_Entity_properties"
    Publications_Item_properties_entities:
      required:
      - description
      - type
      type: object
      properties:
        type:
          type: string
        description:
          type: string
        items:
          $ref: "#/components/schemas/dofpublications_Item_properties_entities_items"
    Publications_Item_properties:
      required:
      - entities
      type: object
      properties:
        id:
          $ref: "#/components/schemas/dofpublications_Entity_properties_id"
        type:
          $ref: "#/components/schemas/dofpublications_Entity_properties_id"
        title:
          $ref: "#/components/schemas/dofpublications_Entity_properties_id"
        issuing_entity:
          $ref: "#/components/schemas/dofpublications_Entity_properties_evidence"
        page_range:
          $ref: "#/components/schemas/dofpublications_Item_properties_page_range"
        raw_text:
          $ref: "#/components/schemas/dofpublications_Entity_properties_evidence"
        summary:
          $ref: "#/components/schemas/dofpublications_Entity_properties_evidence"
        entities:
          $ref: "#/components/schemas/Publications_Item_properties_entities"
    Publications_Item:
      required:
      - description
      - properties
      - type
      type: object
      properties:
        type:
          type: string
        description:
          type: string
        required:
          type: array
          items:
            type: string
        properties:
          $ref: "#/components/schemas/Publications_Item_properties"
